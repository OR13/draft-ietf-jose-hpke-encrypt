<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Aritra Banerjee" name="author">
<meta content="Orie Steele" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="
       This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of
public key encryption of arbitrary-sized plaintexts for a recipient public key. 
       HPKE works for any combination of an asymmetric key encapsulation mechanism (KEM),
key derivation function (KDF), and authenticated encryption with additional data
(AEAD) function. Authentication for HPKE in JOSE is provided by
JOSE-native security mechanisms or by one of the authenticated variants of HPKE. 
       This document defines the use of the HPKE with JOSE. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="HPKE" name="keyword">
<meta content="JOSE" name="keyword">
<meta content="PQC" name="keyword">
<meta content="Hybrid" name="keyword">
<meta content="draft-ietf-jose-hpke-encrypt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-ietf-jose-hpke-encrypt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Use of HPKE in JOSE</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 8 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">JOSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-hpke-encrypt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-07" class="published">7 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-08">8 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
<div class="author">
      <div class="author-name">A. Banerjee</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of
public key encryption of arbitrary-sized plaintexts for a recipient public key.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">HPKE works for any combination of an asymmetric key encapsulation mechanism (KEM),
key derivation function (KDF), and authenticated encryption with additional data
(AEAD) function. Authentication for HPKE in JOSE is provided by
JOSE-native security mechanisms or by one of the authenticated variants of HPKE.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document defines the use of the HPKE with JOSE.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/">https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        jose Working Group mailing list (<span><a href="mailto:jose@ietf.org">mailto:jose@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/jose/">https://mailarchive.ietf.org/arch/browse/jose/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/jose/">https://www.ietf.org/mailman/listinfo/jose/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-hpke-for-jose" class="internal xref">HPKE for JOSE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-hpke-encryption" class="internal xref">HPKE Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-hpke-decryption" class="internal xref">HPKE Decryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-encapsulated-json-web-keys" class="internal xref">Encapsulated JSON Web Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-hpke-direct-encryption" class="internal xref">HPKE Direct Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-hpke-key-encryption" class="internal xref">HPKE Key Encryption</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-ciphersuite-registration" class="internal xref">Ciphersuite Registration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-plaintext-compression" class="internal xref">Plaintext Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-header-parameters" class="internal xref">Header Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-ensure-cryptographic-keys-h" class="internal xref">Ensure Cryptographic Keys Have Sufficient Entropy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-validate-cryptographic-inpu" class="internal xref">Validate Cryptographic Inputs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-use-appropriate-algorithms" class="internal xref">Use Appropriate Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-json-web-key-types" class="internal xref">JSON Web Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-json-web-key-parameters" class="internal xref">JSON Web Key Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-json-web-signature-and-encr" class="internal xref">JSON Web Signature and Encryption Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-json-web-signature-and-encry" class="internal xref">JSON Web Signature and Encryption Header Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Hybrid Public Key Encryption (HPKE) <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> is a scheme that
provides public key encryption of arbitrary-sized plaintexts given a
recipient's public key.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This specification enables JSON Web Encryption (JWE) to leverage HPKE,
bringing support for KEMs and the possibility of Post Quantum or Hybrid KEMs to JWE.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-3">
      <h2 id="name-conventions-and-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-3-1">This specification uses the following abbreviations and terms:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Key Type (kty), see <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Content Encryption Key (CEK), is defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">Hybrid Public Key Encryption (HPKE) is defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">pkR is the public key of the recipient, as defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.5">
          <p id="section-3-2.5.1">skR is the private key of the recipient, as defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.6">
          <p id="section-3-2.6.1">Key Encapsulation Mechanism (KEM), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.7">
          <p id="section-3-2.7.1">Key Derivation Function (KDF), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.8">
          <p id="section-3-2.8.1">Authenticated Encryption with Associated Data (AEAD), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.9">
          <p id="section-3-2.9.1">Additional Authenticated Data (AAD), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="hpke-for-jose">
<section id="section-4">
      <h2 id="name-hpke-for-jose">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-hpke-for-jose" class="section-name selfRef">HPKE for JOSE</a>
      </h2>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1">JSON Web Encryption (JWE) <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> defines several serializations for expressing encrypted content with JSON:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Compact JWE Serialization<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">General JWE JSON Serialization<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Flattened JWE JSON Serialization<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">JSON Web Algorithms (JWA) <span><a href="https://rfc-editor.org/rfc/rfc7518#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> defines two ways to use public key cryptography with JWE:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">Direct Key Agreement<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">Key Agreement with Key Wrapping<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">The specification enables Hybrid Public Key Encryption (HPKE) <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> to be used with the serializations defined in JWE.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Unless otherwise stated, no changes to the processes described in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> have been made.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">This specification describes two modes of use for HPKE in JWE:<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-8.1">
            <p id="section-4.1-8.1.1">HPKE Direct Encryption mode, where HPKE is used to encrypt the plaintext. This mode can only be used with a single recipient. This setup is conceptually similar to Direct Key Agreement.<a href="#section-4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-8.2">
            <p id="section-4.1-8.2.1">HPKE Key Encryption mode, where HPKE is used to encrypt a content encryption key (CEK) and the CEK is subsequently used to encrypt the plaintext. This mode supports multiple recipients. This setup is conceptually similar to Key Agreement with Key Wrapping.<a href="#section-4.1-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-9">When the alg value or enc value is set to any of algorithms registered by this specification then the 'epk' header parameter <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be a JSON Web Key as defined in <a href="#EK" class="auto internal xref">Section 4.4</a> of this document.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">The "ek" member of an 'epk' will contain the base64url encoded "enc" value produced by the encapsulate operation of the HPKE KEM.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">In all serializations, "ct" will be base64url encoded.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">If the 'alg' header parameter is set to the "dir" value (as defined in <a href="#IANA" class="auto internal xref">Section 7</a>), HPKE is used in Direct Encryption mode; otherwise, it is in Key Encryption mode.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">Interested readers will observe this is due to all recipients using the same JWE Protected Header when JSON Serializations are used, as described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1-14">We provide the following table for additional clarity:<a href="#section-4.1-14" class="pilcrow">¶</a></p>
<span id="name-jose-hpke-serializations-an"></span><div id="serialization-mode-table">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-jose-hpke-serializations-an" class="selfRef">JOSE HPKE Serializations and Modes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Recipients</th>
              <th class="text-left" rowspan="1" colspan="1">Serializations</th>
              <th class="text-left" rowspan="1" colspan="1">Content Encryption Key</th>
              <th class="text-left" rowspan="1" colspan="1">Similar to</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Direct Encryption</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Compact, JSON</td>
              <td class="text-left" rowspan="1" colspan="1">Derived from HPKE</td>
              <td class="text-left" rowspan="1" colspan="1">Direct Key Agreement</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Key Encryption</td>
              <td class="text-left" rowspan="1" colspan="1">1 or More</td>
              <td class="text-left" rowspan="1" colspan="1">Compact, JSON</td>
              <td class="text-left" rowspan="1" colspan="1">Encrypted by HPKE</td>
              <td class="text-left" rowspan="1" colspan="1">Key Agreement with Key Wrapping</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="hpke-encryption">
<section id="section-4.2">
        <h3 id="name-hpke-encryption">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-hpke-encryption" class="section-name selfRef">HPKE Encryption</a>
        </h3>
<p id="section-4.2-1">The message encryption process is as follows.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-2">
<li id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">The sending HPKE context is created by invoking invoking SetupBaseS() (Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>) with the recipient's public key "pkR" and "info". The HPKE specification defines the "info" parameter as a context information structure that is used to ensure that the derived keying material is bound to the context of the transaction. The SetupBaseS function will be called with the default value of an empty string for the 'info' parameter. This yields the context "sctxt" and an encapsulation key "enc".<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.2-3">There exist two cases of HPKE plaintext which need to be distinguished:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">
            <p id="section-4.2-4.1.1">In HPKE Direct Encryption mode, the plaintext "pt" passed into Seal
  is the content to be encrypted.  Hence, there is no intermediate
  layer utilizing a CEK.<a href="#section-4.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.2">
            <p id="section-4.2-4.2.1">In HPKE Key Encryption mode, the plaintext "pt" passed into
  Seal is the CEK. The CEK is a random byte sequence of length
  appropriate for the encryption algorithm. For example, AES-128-GCM
  requires a 16 byte key and the CEK would therefore be 16 bytes long.<a href="#section-4.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="hpke-decryption">
<section id="section-4.3">
        <h3 id="name-hpke-decryption">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-hpke-decryption" class="section-name selfRef">HPKE Decryption</a>
        </h3>
<p id="section-4.3-1">The recipient will create the receiving HPKE context by invoking SetupBaseR() (Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>) with "skR", "enc" (output of base64url decoded 'ek'), and "info" (empty string). This yields the context "rctxt". The receiver then decrypts "ct" by invoking the Open() method on "rctxt" (Section 5.2 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>) with "aad", yielding "pt" or an error on failure.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The Open function will, if successful, decrypts "ct".  When decrypted, the result will be either the CEK (when Key Encryption mode is used), or the content (if Direct Encryption mode is used).  The CEK is the symmetric key used to decrypt the ciphertext.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="EK">
<section id="section-4.4">
        <h3 id="name-encapsulated-json-web-keys">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-encapsulated-json-web-keys" class="section-name selfRef">Encapsulated JSON Web Keys</a>
        </h3>
<p id="section-4.4-1">An encapsulated key is represented as JSON Web Key as described in { Section 4 of RFC7515 }.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The "kty" parameter <span class="bcp14">MUST</span> be "EK".<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">The "ek" parameter <span class="bcp14">MUST</span> be present, and <span class="bcp14">MUST</span> be the base64url encoded output of the encap operation defined for the HPKE KEM.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">As described in { Section 4 of RFC7515 }, additional members can be present in the JWK; if not understood by implementations encountering them, they <span class="bcp14">MUST</span> be ignored.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">This example demonstrates the representaton of an encapsulated key as a JWK.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-6">
<pre>
{
   "kty": "EK",
   "ek": "BHpP-u5JKziyUpqxNQqb0apHx1ecH2UzcRlhHR4ngJVS__gNu21DqqgPweu
   PpjglnXDnOuQ4kt9tHCs3PUzPxQs"
}
</pre><a href="#section-4.4-6" class="pilcrow">¶</a>
</div>
<div id="hpke-direct-encryption">
<section id="section-4.4.1">
          <h4 id="name-hpke-direct-encryption">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-hpke-direct-encryption" class="section-name selfRef">HPKE Direct Encryption</a>
          </h4>
<p id="section-4.4.1-1">This mode only supports a single recipient.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">HPKE is employed to directly encrypt the plaintext, and the resulting ciphertext is included in the JWE ciphertext.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">In HPKE Direct Encryption mode:<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-4.1">
              <p id="section-4.4.1-4.1.1">The "epk" Header Parameter <span class="bcp14">MUST</span> be present, it <span class="bcp14">MUST</span> contain an Encapsulated JSON Web Key and it <span class="bcp14">MUST</span> occur only within the JWE Protected Header.<a href="#section-4.4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.2">
              <p id="section-4.4.1-4.2.1">The "alg" Header Parameter <span class="bcp14">MUST</span> be "dir", "enc" <span class="bcp14">MUST</span> be an HPKE algorithm from JSON Web Signature and Encryption Algorithms in <span>[<a href="#JOSE-IANA" class="cite xref">JOSE-IANA</a>]</span> and they <span class="bcp14">MUST</span> occur only within the JWE Protected Header.<a href="#section-4.4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.3">
              <p id="section-4.4.1-4.3.1">The JWE Ciphertext <span class="bcp14">MUST</span> be the resulting HPKE ciphertext ('ct' value) encoded using base64url.<a href="#section-4.4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.4">
              <p id="section-4.4.1-4.4.1">The JWE Initialization Vector value <span class="bcp14">MUST</span> be absent.<a href="#section-4.4.1-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.5">
              <p id="section-4.4.1-4.5.1">The JWE Authentication Tag <span class="bcp14">MUST</span> be absent.<a href="#section-4.4.1-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.6">
              <p id="section-4.4.1-4.6.1">The JWE Encrypted Key <span class="bcp14">MUST</span> be absent.<a href="#section-4.4.1-4.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-4.7">
              <p id="section-4.4.1-4.7.1">The HPKE "aad" parameter <span class="bcp14">MUST</span> be set to the JWE Additional Authenticated Data encryption parameter defined in Step 14 of Section 5.1 of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> as input.<a href="#section-4.4.1-4.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.1-5">The following example demonstrates the use of Direct Encryption with Compact Serialization:<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.4.1-6">Note that newlines are for readability.<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<span id="name-direct-encryption-with-comp"></span><div id="direct-encryption-compact">
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-4.4.1-7.1">
<pre>
eyJhbGciOiJkaXIiLCJlbmMiOiJIUEtFLUJhc2UtUDI1Ni1TSEEyNTYtQUVTMTI4R0NNIi
wiZXBrIjp7Imt0eSI6IkVLIiwiZWsiOiJCR05ranp0MDc2YnNSR2o3OGFYNUF6VF9IRU9K
QmJZOXEyWm9fNWU3dGJLMGFQcXU0ZVQxV0kxNmp2UmxacXBNeXFaZlAtUndSNEp3dGF6Xz
hVOXRoWEEifX0...DG3qygxcMHw3iACy5mX_T4N4EqWc03W0nkTHjMJsC4nb6JS6vVj6wT
Gdlr5TOSr0ykaoyzpePXEvEyHhvpUwCyQQr6kbGlGuZsrJdUbZ728vmA.
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-direct-encryption-with-comp" class="selfRef">Direct Encryption with Compact Serialization</a>
            </figcaption></figure>
</div>
<p id="section-4.4.1-8">In the above example, the JWE Protected Header value is:<a href="#section-4.4.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.1-9">
<pre>
{
  "alg": "dir",
  "enc": "HPKE-P256-SHA256-A128GCM",
  "epk": {
    "kty": "EK",
    "ek":
    "BGNkjzt076bsRGj78aX5AzT_HEOJBbY9q2Zo_5e7tbK0aPqu4eT1WI16jvRlZqpM
    yqZfP-RwR4Jwtaz_8U9thXA"
  }
}
</pre><a href="#section-4.4.1-9" class="pilcrow">¶</a>
</div>
<span id="name-direct-encryption-with-json"></span><div id="direct-encryption-json">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-4.4.1-10.1">
<pre>
{
    "protected": "eyJhbGciOiJkaXIiLCJlbmMiOiJIUEtFLUJhc2UtUDI1Ni1TSEE
    yNTYtQUVTMTI4R0NNIiwiZXBrIjp7Imt0eSI6IkVLIiwiZWsiOiJCTzRFbGZXd0xK
    RDZWcERza3c5LWxWMm9OMDJ2U1FKTW55ZHk3enhvSVlKZ1kydk9taE44Q1BqSHdRM
    1NONkhTcnNHNElacVpHVUR3dExKZjBoeHFTWGsifX0",
    "ciphertext": "1ATsw0jshqPrv8CFcm9Rem9Wfi1Ygv30sozlRTtNNzcaaZ828G
    qP0AXtqQ1Msv8YXI9XZqh81MK3QnlZ7pOBC1BP7j00J1rrHujdb3zvnOpmJg"
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-direct-encryption-with-json" class="selfRef">Direct Encryption with JSON Serialization</a>
            </figcaption></figure>
</div>
<p id="section-4.4.1-11">In the above example, the JWE Protected Header value is:<a href="#section-4.4.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.1-12">
<pre>
{
  "alg": "dir",
  "enc": "HPKE-P256-SHA256-A128GCM",
  "epk": {
    "kty": "EK",
    "ek": "BGNkjzt076bsRGj78aX5AzT_HEOJBbY9q2Zo_5e7tbK0aPqu4eT1WI16jv
    RlZqpMyqZfP-RwR4Jwtaz_8U9thXA"
  }
}
</pre><a href="#section-4.4.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hpke-key-encryption">
<section id="section-4.4.2">
          <h4 id="name-hpke-key-encryption">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-hpke-key-encryption" class="section-name selfRef">HPKE Key Encryption</a>
          </h4>
<p id="section-4.4.2-1">This mode supports more than one recipient.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">HPKE is used to encrypt the Content Encryption Key (CEK), and the resulting ciphertext is included in the JWE Encrypted Key. The plaintext will be encrypted using the CEK as explained in Step 15 of Section 5.1 of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-3">When there are multiple recipients, the sender <span class="bcp14">MUST</span> place the 'epk' parameter in the per-recipient unprotected header to indicate the use of HPKE. In this case, the 'enc' (Encryption Algorithm) Header Parameter <span class="bcp14">MUST</span> be a content encryption algorithm from JSON Web Signature and Encryption Algorithms in <span>[<a href="#JOSE-IANA" class="cite xref">JOSE-IANA</a>]</span>, and it <span class="bcp14">MUST</span> be present in the JWE Protected Header. The integrity-protected 'enc' parameter provides protection against an attacker who manipulates the encryption algorithm in the 'enc' parameter. This attack is discussed in <span>[<a href="#I-D.draft-ietf-lamps-cms-cek-hkdf-sha256" class="cite xref">I-D.draft-ietf-lamps-cms-cek-hkdf-sha256</a>]</span>.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4">In HPKE Key Encryption mode:<a href="#section-4.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-5.1">
              <p id="section-4.4.2-5.1.1">The JWE Encrypted Key <span class="bcp14">MUST</span> be the resulting HPKE ciphertext ('ct' value) encoded using base64url.<a href="#section-4.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.2-6">The following example demonstrates the use of Key Encryption with General JSON Serialization:<a href="#section-4.4.2-6" class="pilcrow">¶</a></p>
<span id="name-key-encryption-multiple-rec"></span><div id="key-encryption-multiple-recipient-general-json">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-4.4.2-7.1">
<pre>
{
  "protected": "eyJlbmMiOiJBMTI4R0NNIn0",
  "ciphertext": "S0qqrM3xXPUavbmL9LQkgUKRBu8BZ7DQWoT-mdNIZVU-ip_V-fbM
  okiGwp2aPM57DX3cXCK3TKHqdhZ8rSNduUja",
  "iv": "AzaXpooLg3ZxEASQ",
  "aad": "8J-SgCBhYWQ",
  "tag": "S0omWw35S0H7tyEHsmGLDw",
  "recipients": [
    {
      "encrypted_key": "yDVZLsO7-ecy_GCgEluwn9U723TCHNAzeYRRQPOfpHM",
      "header": {
        "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:adjwW6fy
        yZ94ZBjGjx_OpDEKHLGfd1ELkug_YmRAjCk",
        "alg": "HPKE-P256-SHA256-A128GCM",
        "epk": {
          "kty": "EK",
          "ek": "BHpP-u5JKziyUpqxNQqb0apHx1ecH2UzcRlhHR4ngJVS__gNu21D
          qqgPweuPpjglnXDnOuQ4kt9tHCs3PUzPxQs"
        }
      }
    },
    {
      "encrypted_key": "iS73TFqJ61gkmh4DHAXADx4wyftA7pnY",
      "header": {
        "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:D2FKlj9M
        TIQma5bwdOVXk5Zh3_d60knzlbmD-SyMNAI",
        "alg": "ECDH-ES+A128KW",
        "epk": {
          "kty": "EC",
          "crv": "P-256",
          "x": "nX6Y3DWC0olVe5H7-NkCzVDghsYSa_L9da3jzkHYkV8",
          "y": "wDshQdcaY0J08wx25V3ystQSNe_qjsCaaFeeRWJqcE0"
        }
      }
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-key-encryption-multiple-rec" class="selfRef">Key Encryption (multiple recipient) General JSON Serialization</a>
            </figcaption></figure>
</div>
<p id="section-4.4.2-8">In the above example, the JWE Protected Header value is:<a href="#section-4.4.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-9">
<pre>
{
   "enc": "A128GCM"
}
</pre><a href="#section-4.4.2-9" class="pilcrow">¶</a>
</div>
<span id="name-key-encryption-single-recip"></span><div id="key-encryption-single-recipient-flattened-json">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-4.4.2-10.1">
<pre>
{
  "protected": "eyJhbGciOiAiSFBLRS1CYXNlLVAyNTYtU0hBMjU2LUFFUzEyOEdDT
  SIsImVuYyI6IkExMjhHQ00iLCJlcGsiOnsia3R5IjoiRUsiLCJlayI6IkJQUlRLbjht
  UUw0aE4xYXlva1I4Z2twVHk1SFFsZDROMEhYWEI5Y1h0alVJUTM3enNKREw3VHVnVmt
  tRDFhRllUeC0wYk0wdGZ4emVqTGN0U0RLak1RcyJ9fQ",
  "encrypted_key": "zR0ArfrVVRQ9-X_heDU2riwx36QxLBffRrKAWU-tLC4",
  "iv": "o3v11Hw6gUxUN-pY",
  "ciphertext": "Ny-2IDGHMI3MzVsUAVMGNoKAZfoewTZ1dkAIBikPy4eZUfHW_LPh
  hKpD6Mf4zYGkhAeLwGgJKjyDoFIj0EuDsEtJ",
  "tag": "0sfzHJvxVoWt02EPxMTh8w"
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-key-encryption-single-recip" class="selfRef">Key Encryption (single recipient) Flattened JSON Serialization</a>
            </figcaption></figure>
</div>
<p id="section-4.4.2-11">In the above example, the JWE Protected Header value is:<a href="#section-4.4.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-12">
<pre>
{

  "alg": "HPKE-P256-SHA256-A128GCM",
  "enc": "A128GCM",
  "epk": {
    "kty": "EK",
    "ek": "BPRTKn8mQL4hN1ayokR8gkpTy5HQld4N0HXXB9cXtjUIQ37zsJDL7TugVk
    mD1aFYTx-0bM0tfxzejLctSDKjMQs"
  }
}
</pre><a href="#section-4.4.2-12" class="pilcrow">¶</a>
</div>
<span id="name-key-encryption-single-recipi"></span><div id="key-encryption-single-recipient-compact">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-4.4.2-13.1">
<pre>
eyJhbGciOiAiSFBLRS1CYXNlLVAyNTYtU0hBMjU2LUFFUzEyOEdDTSIsImVuYyI6IkExM
jhHQ00iLCJlcGsiOnsia3R5IjoiRUsiLCJlayI6IkJKN3JkTmJrdnd1bnNzZGp1NVdEa0
FhekxhQlgzSWRjTFJqeTFSRFNBOXNpajAwamR5YmFIdVFQVHQ2UDMxQmkwbkUya1lXXzd
MX3RhQXFBRks3NURlayJ9fQ.xaAa0nFxNJxsQQ5J6EFdzUYROd2aV517o2kZnfwhO7s.A
gBYEWTj-EMji17I.Ejwu2iEP4xs3FfGO_zTZYu35glQmUvd_qpHpvB1hNqg6Yz5ek3NsZ
RGMzd--HYWvABNslxBkRwrkZDXnv_BTgOTj.u0ac86ipoAwUZuYwkaKwNw
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-key-encryption-single-recipi" class="selfRef">Key Encryption (single recipient) Compact</a>
            </figcaption></figure>
</div>
<p id="section-4.4.2-14">In the above example, the JWE Protected Header value is:<a href="#section-4.4.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-15">
<pre>
{
  "alg": "HPKE-P256-SHA256-A128GCM",
  "enc": "A128GCM",
  "epk": {
    "kty": "EK",
    "ek": "BJ7rdNbkvwunssdju5WDkAazLaBX3IdcLRjy1RDSA9sij00jdybaHuQPTt
    6P31Bi0nE2kYW_7L_taAqAFK75Dek"
  }
}
</pre><a href="#section-4.4.2-15" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ciphersuite-registration">
<section id="section-5">
      <h2 id="name-ciphersuite-registration">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-ciphersuite-registration" class="section-name selfRef">Ciphersuite Registration</a>
      </h2>
<p id="section-5-1">This specification registers a number of ciphersuites for use with HPKE.
A ciphersuite is a group of algorithms, often sharing component algorithms such as hash functions, targeting a security level.
An HPKE ciphersuite, is composed of the following choices:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">HPKE Mode<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">KEM Algorithm<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">KDF Algorithm<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">AEAD Algorithm<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">The "KEM", "KDF", and "AEAD" values are chosen from the HPKE IANA registry <span>[<a href="#HPKE-IANA" class="cite xref">HPKE-IANA</a>]</span>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">For readability the algorithm ciphersuites labels are built according to the following scheme:<a href="#section-5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-5">
<pre>
HPKE-&lt;KEM&gt;-&lt;KDF&gt;-&lt;AEAD&gt;
</pre><a href="#section-5-5" class="pilcrow">¶</a>
</div>
<p id="section-5-6">The "HPKE Mode" is described in Table 1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">
          <p id="section-5-7.1.1">"Base" refers to "mode_base" described in Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which only enables encryption to the holder of a given KEM private key.<a href="#section-5-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.2">
          <p id="section-5-7.2.1">"PSK" refers to "mode_psk", described in Section 5.1.2 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using a pre-shared key.<a href="#section-5-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.3">
          <p id="section-5-7.3.1">"Auth" refers to "mode_auth", described in Section 5.1.3 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using an asymmetric key.<a href="#section-5-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.4">
          <p id="section-5-7.4.1">"Auth_Psk" refers to "mode_auth_psk", described in Section 5.1.4 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using both a PSK and an asymmetric key.<a href="#section-5-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-8">Implementations detect the use of modes by inspecting header parameters.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">For a list of ciphersuite registrations, please see <a href="#IANA" class="auto internal xref">Section 7</a>.<a href="#section-5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">This specification is based on HPKE and the security considerations of
<span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> are therefore applicable also to this specification.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">HPKE assumes the sender is in possession of the public key of the recipient and
HPKE JOSE makes the same assumptions. Hence, some form of public key distribution
mechanism is assumed to exist but outside the scope of this document.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">HPKE in Base mode does not offer authentication as part of the HPKE KEM. In this case
JOSE constructs like JWS and JSON Web Tokens (JWTs) can be used to add authentication.
HPKE also offers modes that offer authentication.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">HPKE relies on a source of randomness to be available on the device. In Key Agreement
with Key Wrapping mode, CEK has to be randomly generated and it <span class="bcp14">MUST</span> be
ensured that the guidelines in <span>[<a href="#RFC8937" class="cite xref">RFC8937</a>]</span> for random number generations are followed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="plaintext-compression">
<section id="section-6.1">
        <h3 id="name-plaintext-compression">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-plaintext-compression" class="section-name selfRef">Plaintext Compression</a>
        </h3>
<p id="section-6.1-1">Implementers are advised to review Section 3.6 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which states:
Compression of data <span class="bcp14">SHOULD NOT</span> be done before encryption, because such compressed data often reveals information about the plaintext.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-parameters">
<section id="section-6.2">
        <h3 id="name-header-parameters">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-header-parameters" class="section-name selfRef">Header Parameters</a>
        </h3>
<p id="section-6.2-1">Implementers are advised to review Section 3.10 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which comments on application processing of JWE Protected Headers.
Additionally, Unprotected Headers can contain similar information which an attacker could leverage to mount denial of service, forgery or injection attacks.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ensure-cryptographic-keys-have-sufficient-entropy">
<section id="section-6.3">
        <h3 id="name-ensure-cryptographic-keys-h">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-ensure-cryptographic-keys-h" class="section-name selfRef">Ensure Cryptographic Keys Have Sufficient Entropy</a>
        </h3>
<p id="section-6.3-1">Implementers are advised to review Section 3.5 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which provides comments on entropy requirements for keys. This guidance is relevant to both public and private keys used in both Key Encryption and Direct Encryption. Additionally, this guidance is applicable to content encryption keys used in Key Encryption mode.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-cryptographic-inputs">
<section id="section-6.4">
        <h3 id="name-validate-cryptographic-inpu">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-validate-cryptographic-inpu" class="section-name selfRef">Validate Cryptographic Inputs</a>
        </h3>
<p id="section-6.4-1">Implementers are advised to review Section 3.4 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which provides comments on the validation of cryptographic inputs. This guidance is relevant to both public and private keys used in both Key Encryption and Direct Encryption, specifically focusing on the structure of the public and private keys, as well as the 'ek' value. These inputs are crucial for the HPKE KEM operations.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-appropriate-algorithms">
<section id="section-6.5">
        <h3 id="name-use-appropriate-algorithms">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-use-appropriate-algorithms" class="section-name selfRef">Use Appropriate Algorithms</a>
        </h3>
<p id="section-6.5-1">Implementers are advised to review Section 3.2 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which comments on the selection of appropriate algorithms.
This is guidance is relevant to both Key Encryption and Direct Encryption.
When using Key Encryption, the strength of the content encryption algorithm should not be significantly different from the strengh of the Key Encryption algorithms used.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document adds entries to <span>[<a href="#JOSE-IANA" class="cite xref">JOSE-IANA</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="json-web-key-types">
<section id="section-7.1">
        <h3 id="name-json-web-key-types">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-json-web-key-types" class="section-name selfRef">JSON Web Key Types</a>
        </h3>
<p id="section-7.1-1">The following entry is added to the "JSON Web Key Types" registry:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">"kty" Parameter Value: "EK"<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">Key Type Description: HPKE Encapsulated Key Type (See issue #18)<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.3">
            <p id="section-7.1-2.3.1">JOSE Implementation Requirements: Optional<a href="#section-7.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.4">
            <p id="section-7.1-2.4.1">Change Controller: IETF<a href="#section-7.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.5">
            <p id="section-7.1-2.5.1">Specification Document(s):   RFCXXXX<a href="#section-7.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="json-web-key-parameters">
<section id="section-7.2">
        <h3 id="name-json-web-key-parameters">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-json-web-key-parameters" class="section-name selfRef">JSON Web Key Parameters</a>
        </h3>
<p id="section-7.2-1">The following entry is added to the "JSON Web Key Parameters" registry:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">Parameter Name: "ek"<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">Parameter Description: Encapsulated Key<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.3">
            <p id="section-7.2-2.3.1">Parameter Information Class: Public<a href="#section-7.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.4">
            <p id="section-7.2-2.4.1">Used with "kty" Value(s): "EK"<a href="#section-7.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.5">
            <p id="section-7.2-2.5.1">Specification Document(s):   RFCXXXX<a href="#section-7.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="json-web-signature-and-encryption-algorithms">
<section id="section-7.3">
        <h3 id="name-json-web-signature-and-encr">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-json-web-signature-and-encr" class="section-name selfRef">JSON Web Signature and Encryption Algorithms</a>
        </h3>
<p id="section-7.3-1">The following entries are added to the "JSON Web Signature and Encryption Algorithms" registry:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">Algorithm Name: HPKE-P256-SHA256-A128GCM<a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-256, HKDF-SHA256) KEM, the HKDF-SHA256 KDF and the AES-128-GCM AEAD.<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.3">
            <p id="section-7.3-2.3.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.4">
            <p id="section-7.3-2.4.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.5">
            <p id="section-7.3-2.5.1">Change Controller: IETF<a href="#section-7.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.6">
            <p id="section-7.3-2.6.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.7">
            <p id="section-7.3-2.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.8">
            <p id="section-7.3-2.8.1">Algorithm Name: HPKE-P384-SHA384-A256GCM<a href="#section-7.3-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.9">
            <p id="section-7.3-2.9.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-384, HKDF-SHA384) KEM, the HKDF-SHA384 KDF, and the AES-256-GCM AEAD.<a href="#section-7.3-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.10">
            <p id="section-7.3-2.10.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.11">
            <p id="section-7.3-2.11.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.12">
            <p id="section-7.3-2.12.1">Change Controller: IETF<a href="#section-7.3-2.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.13">
            <p id="section-7.3-2.13.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.14">
            <p id="section-7.3-2.14.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.15">
            <p id="section-7.3-2.15.1">Algorithm Name: HPKE-P521-SHA512-A256GCM<a href="#section-7.3-2.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.16">
            <p id="section-7.3-2.16.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-521, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD.<a href="#section-7.3-2.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.17">
            <p id="section-7.3-2.17.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.18">
            <p id="section-7.3-2.18.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.19">
            <p id="section-7.3-2.19.1">Change Controller: IETF<a href="#section-7.3-2.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.20">
            <p id="section-7.3-2.20.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.20.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.21">
            <p id="section-7.3-2.21.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.21.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.22">
            <p id="section-7.3-2.22.1">Algorithm Name: HPKE-X25519-SHA256-A128GCM<a href="#section-7.3-2.22.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.23">
            <p id="section-7.3-2.23.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the AES-128-GCM AEAD.<a href="#section-7.3-2.23.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.24">
            <p id="section-7.3-2.24.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.24.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.25">
            <p id="section-7.3-2.25.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.25.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.26">
            <p id="section-7.3-2.26.1">Change Controller: IETF<a href="#section-7.3-2.26.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.27">
            <p id="section-7.3-2.27.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.27.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.28">
            <p id="section-7.3-2.28.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.28.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.29">
            <p id="section-7.3-2.29.1">Algorithm Name: HPKE-X25519-SHA256-ChaCha20Poly1305<a href="#section-7.3-2.29.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.30">
            <p id="section-7.3-2.30.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the ChaCha20Poly1305 AEAD.<a href="#section-7.3-2.30.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.31">
            <p id="section-7.3-2.31.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.31.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.32">
            <p id="section-7.3-2.32.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.32.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.33">
            <p id="section-7.3-2.33.1">Change Controller: IETF<a href="#section-7.3-2.33.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.34">
            <p id="section-7.3-2.34.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.34.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.35">
            <p id="section-7.3-2.35.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.35.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.36">
            <p id="section-7.3-2.36.1">Algorithm Name: HPKE-X448-SHA512-A256GCM<a href="#section-7.3-2.36.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.37">
            <p id="section-7.3-2.37.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD.<a href="#section-7.3-2.37.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.38">
            <p id="section-7.3-2.38.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.38.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.39">
            <p id="section-7.3-2.39.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.39.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.40">
            <p id="section-7.3-2.40.1">Change Controller: IETF<a href="#section-7.3-2.40.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.41">
            <p id="section-7.3-2.41.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.41.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.42">
            <p id="section-7.3-2.42.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.42.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.43">
            <p id="section-7.3-2.43.1">Algorithm Name: HPKE-X448-SHA512-ChaCha20Poly1305<a href="#section-7.3-2.43.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.44">
            <p id="section-7.3-2.44.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the ChaCha20Poly1305 AEAD.<a href="#section-7.3-2.44.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.45">
            <p id="section-7.3-2.45.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-7.3-2.45.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.46">
            <p id="section-7.3-2.46.1">JOSE Implementation Requirements: Optional<a href="#section-7.3-2.46.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.47">
            <p id="section-7.3-2.47.1">Change Controller: IETF<a href="#section-7.3-2.47.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.48">
            <p id="section-7.3-2.48.1">Specification Document(s):   RFCXXXX<a href="#section-7.3-2.48.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.49">
            <p id="section-7.3-2.49.1">Algorithm Analysis Documents(s): TODO<a href="#section-7.3-2.49.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="json-web-signature-and-encryption-header-parameters">
<section id="section-7.4">
        <h3 id="name-json-web-signature-and-encry">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-json-web-signature-and-encry" class="section-name selfRef">JSON Web Signature and Encryption Header Parameters</a>
        </h3>
<p id="section-7.4-1">The following entries are added to the "JSON Web Key Parameters" registry:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">
            <p id="section-7.4-2.1.1">Parameter Name: "psk_id"<a href="#section-7.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.2">
            <p id="section-7.4-2.2.1">Parameter Description: A key identifier (kid) for the pre-shared key as defined in { Section 5.1.1 of RFC9180 }<a href="#section-7.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.3">
            <p id="section-7.4-2.3.1">Parameter Information Class: Public<a href="#section-7.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.4">
            <p id="section-7.4-2.4.1">Used with "kty" Value(s): *<a href="#section-7.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.5">
            <p id="section-7.4-2.5.1">Change Controller: IETF<a href="#section-7.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.6">
            <p id="section-7.4-2.6.1">Specification Document(s):   RFCXXXX<a href="#section-7.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.7">
            <p id="section-7.4-2.7.1">Parameter Name: "auth_kid"<a href="#section-7.4-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.8">
            <p id="section-7.4-2.8.1">Parameter Description: A key identifier (kid) for the asymmetric key as defined in { Section 5.1.4 of RFC9180 }<a href="#section-7.4-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.9">
            <p id="section-7.4-2.9.1">Parameter Information Class: Public<a href="#section-7.4-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.10">
            <p id="section-7.4-2.10.1">Used with "kty" Value(s): *<a href="#section-7.4-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.11">
            <p id="section-7.4-2.11.1">Change Controller: IETF<a href="#section-7.4-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.12">
            <p id="section-7.4-2.12.1">Specification Document(s):   RFCXXXX<a href="#section-7.4-2.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="JOSE-IANA">[JOSE-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose/jose.xhtml">https://www.iana.org/assignments/jose/jose.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8725">https://www.rfc-editor.org/rfc/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="HPKE-IANA">[HPKE-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Hybrid Public Key Encryption (HPKE) IANA Registry"</span>, <time datetime="2023-10" class="refDate">October 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/hpke/hpke.xhtml">https://www.iana.org/assignments/hpke/hpke.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-lamps-cms-cek-hkdf-sha256">[I-D.draft-ietf-lamps-cms-cek-hkdf-sha256]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Encryption Key Derivation in the Cryptographic Message Syntax (CMS) using HKDF with SHA-256"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-cek-hkdf-sha256-01</span>, <time datetime="2024-03-18" class="refDate">18 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-cek-hkdf-sha256-01">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-cek-hkdf-sha256-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-hpke">[I-D.ietf-cose-hpke]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Steele, O.</span>, <span class="refAuthor">Daisuke, A.</span>, and <span class="refAuthor">L. Lundblade</span>, <span class="refTitle">"Use of Hybrid Public-Key Encryption (HPKE) with CBOR Object Signing and Encryption (COSE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-hpke-07</span>, <time datetime="2023-10-22" class="refDate">22 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-07">https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
      <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8937">https://www.rfc-editor.org/rfc/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">This specification leverages text from <span>[<a href="#I-D.ietf-cose-hpke" class="cite xref">I-D.ietf-cose-hpke</a>]</span>. We would like to thank Matt Chanda, Ilari Liusvaara, Aaron Parecki and Filip Skokan for their feedback.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">-01<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">Remove HPKE Mode from named algorithms<a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Fix AEAD named algorithms<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-3">-00<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">Created initial working group version from draft-rha-jose-hpke-encrypt-07<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aritra Banerjee</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="locality">Munich</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aritra.banerjee@nokia.com" class="email">aritra.banerjee@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
